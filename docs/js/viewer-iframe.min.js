window.NACSS=window.NACSS||{},window.NACSS.viewer=window.NACSS.viewer||{},(e=>{function t(e,t=!0){let n=2166136261;for(let t=0;t<e.length;t+=1)n^=e.charCodeAt(t),n+=(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24);if(t){const e="0000000"+(n>>>0).toString(16);return e.substring(e.length-8)}return n>>>0}const n=new Map;function s(e,t,n=!0,s=""){const i=t.substr(1);if(t.startsWith(":"))n?e.dataset[i]=s:delete e.dataset[i];else{const t=[i,s].join("-");n?e.classList.add(t):e.classList.remove(t)}}const i=[];function o(e,t=!1){t&&e(),i.push(function(e){let t;return(...n)=>{t||(t=!0,requestAnimationFrame((()=>{t=!1,e(...n)})))}}(e))}function l(e,t,n){if(0!==location.hash.indexOf("#"+t))return;const s=n.replace("#"+t,"");if(s)for(const[t,n]of e)if(t===s){null!==r&&r!==t&&d(e.get(r)),null!==r&&r===t||c(n);break}}document.addEventListener("DOMContentLoaded",(()=>{window.addEventListener("resize",(()=>{for(const e of i)e()}),{passive:!0})})),e.applyIframe=function(e,i,u={}){if(0===e.length)return;u=Object.assign({styleOpener:":ncViewerOpener",styleOpenerWrapper:":ncViewerOpenerWrapper"},u);!function(e,t={}){if(0===e.length)return;t=Object.assign({styleRoot:":ncViewer",styleCloser:":ncViewerCloser",stylePrev:":ncViewerPrev",styleNext:":ncViewerNext",styleCaption:":ncViewerCaption",styleOpen:":ncOpen",styleVisible:":ncVisible",styleInstantly:":ncInstantly",hashPrefix:"viewer:"},t);const n=new Map;let s=null;for(const i of e){const e=a(t,i.id,i.frameInst,i.frame,i.caption,s);i.opener.addEventListener("click",(t=>p(e,t))),n.set(i.id,e),s=e}(function(e){o((()=>{for(const t of e.values())t.fi.doResize();setTimeout((()=>{for(const t of e.values())t.fi.doResize()}),200)})),window.addEventListener("keydown",(t=>{if(null!==r&&!t.altKey&&!t.ctrlKey&&!t.shiftKey){const n=e.get(r);"Escape"===t.key?n.dlg.click():"ArrowLeft"===t.key?n.btnPrev.click():"ArrowRight"===t.key&&n.btnNext.click()}}))})(n),function(e,t){window.addEventListener("popstate",(t=>{null!==r&&e.has(r)&&d(e.get(r)),t.state&&"nc-viewer"===t.state.name&&void 0!==t.state.id&&e.has(t.state.id)&&c(e.get(t.state.id))})),window.addEventListener("hashchange",(()=>l(e,t,location.hash))),l(e,t,location.hash)}(n,t.hashPrefix)}(e.map(((e,o)=>{const l=function(e,s=!0){if(n.has(e)){const i=n.get(e);return n.set(e,i+1),t(e+i,s)}return n.set(e,1),t(e,s)}(i[o].src),[r,a]=function(e,t){e=Object.assign({styleIframeFrame:":ncFrameIframe",styleLoaded:":ncLoaded"},e);const n=function(e){if(e.startsWith("https://www.youtube.com")){const t=new URL(e),n=new URLSearchParams(t.search);n.append("enablejsapi",1),t.search=n,e=t.toString()}return e}(t.src);if(t.removeAttribute("src"),t.setAttribute("data-nc-lazy",""),!t.style.aspectRatio){const[e,n]=function(e){let t=parseInt(e.width),n=parseInt(e.height);if(t&&n)return[t,n];const s=e.style.width,i=e.style.height;return s.indexOf("px")!==s.length-2||i.indexOf("px")!==i.length-2?[0,0]:(t=parseInt(s),n=parseInt(i),t&&n?[t,n]:[0,0])}(t);e&&n&&(t.style.aspectRatio=`${e} / ${n}`)}const i={opts:e,src:n,ifm:t,scale:1,realScale:1,baseSize:null,isLs:!1,margin:0,frm:null};return i.frm=document.createElement("div"),s(i.frm,i.opts.styleIframeFrame),i.ifm.addEventListener("click",(e=>e.stopPropagation())),i.frm.appendChild(i.ifm),i.doResize=()=>{},i.doOpen=()=>function(e){const t=e.ifm;t.hasAttribute("data-nc-lazy")&&(t.removeAttribute("data-nc-lazy"),t.style.opacity="0",t.addEventListener("load",(()=>{s(e.frm,e.opts.styleLoaded),setTimeout((()=>{t.style.opacity="1"}),0)})),t.contentDocument.location.replace(e.src))}(i),i.doClose=()=>function(e){e.src.startsWith("https://www.youtube.com")&&e.ifm.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}(i),[i,i.frm]}(u,i[o]);return function(e,t){s(e,t)}(e,u.styleOpener),{opener:e,id:l,frameInst:r,frame:a,caption:null}})),u)};let r=null;function a(e,t,n,i,o,l=null){const r={};r.opts=e,r.fi=n,r.id=t,r.dlg=document.createElement("div"),s(r.dlg,e.styleRoot),r.dlg.addEventListener("click",(e=>function(e){e.preventDefault(),history.back()}(e))),r.dlg.appendChild(i);const a=document.createElement("button");if(s(a,e.styleCloser),r.dlg.appendChild(a),r.btnPrev=document.createElement("button"),r.btnNext=document.createElement("button"),s(r.btnPrev,e.stylePrev),s(r.btnNext,e.styleNext),r.dlg.appendChild(r.btnPrev),r.dlg.appendChild(r.btnNext),o){const t=document.createElement("div");t.innerHTML=`<span>${o}</span>`,s(t,e.styleCaption),r.dlg.appendChild(t)}return document.body.appendChild(r.dlg),function(e,t){e.btnNext.style.display="none",t?(e.btnPrev.addEventListener("click",(n=>{n.stopPropagation(),d(e,!0),c(t,!0)})),function(e,t){e.btnNext.addEventListener("click",(n=>{n.stopPropagation(),d(e,!0),c(t,!0)})),e.btnNext.style.display=null}(t,e)):e.btnPrev.style.display="none"}(r,l),l=r,r}function c(e,t=!1){if(s(e.dlg,e.opts.styleOpen),e.fi.doOpen(),t){e.fi.doResize(),s(e.dlg,e.opts.styleInstantly),s(e.dlg,e.opts.styleVisible),setTimeout((()=>{s(e.dlg,e.opts.styleInstantly,!1)}),20);const t="#"+e.opts.hashPrefix+e.id;history.replaceState(null,"",t)}else setTimeout((()=>{e.fi.doResize(),s(e.dlg,e.opts.styleVisible)}),0);r=e.id;const n=getComputedStyle(document.documentElement);n.marginTop&&(e.dlg.style.top=n.marginTop)}function d(e,t=!1){e.fi.doClose(),t?(s(e.dlg,e.opts.styleInstantly),s(e.dlg,e.opts.styleVisible,!1),setTimeout((()=>{s(e.dlg,e.opts.styleInstantly,!1)}),20)):s(e.dlg,e.opts.styleVisible,!1),setTimeout((()=>{s(e.dlg,e.opts.styleOpen,!1)}),200),r=null}function p(e,t){if(t.preventDefault(),c(e),location.hash){const e=location.href.substring(0,location.href.indexOf("#"));history.replaceState(null,"",e)}const n="#"+e.opts.hashPrefix+e.id;history.pushState({name:"nc-viewer",id:e.id},null,n)}})(window.NACSS.viewer);
//# sourceMappingURL=viewer-iframe.min.js.map